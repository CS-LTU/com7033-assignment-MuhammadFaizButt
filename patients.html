{% extends "base.html" %}

{% block title %}Patients List - Stroke Prediction System{% endblock %}

{% block content %}
<div class="card">
    <h2>Patients List</h2>
    <p>View and manage all patient records</p>
    
    <div style="margin-top: 20px;">
        <a href="{{ url_for('add_patient') }}" class="btn btn-success">Add New Patient</a>
    </div>
    
    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Gender</th>
                    <th>Age</th>
                    <th>Hypertension</th>
                    <th>Ever Married</th>
                    <th>Work Type</th>
                    <th>Residence</th>
                    <th>Glucose</th>
                    <th>BMI</th>
                    <th>Smoking</th>
                    <th>Stroke</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% if patients %}
                    {% for patient in patients %}
                    <tr>
                        <td>{{ patient.id }}</td>
                        <td>{{ patient.gender }}</td>
                        <td>{{ patient.age }}</td>
                        <td>{{ 'Yes' if patient.hypertension == 1 else 'No' }}</td>
                        <td>{{ patient.ever_married }}</td>
                        <td>{{ patient.work_type }}</td>
                        <td>{{ patient.Residence_type }}</td>
                        <td>{{ patient.avg_glucose_level }}</td>
                        <td>{{ patient.bmi if patient.bmi else 'N/A' }}</td>
                        <td>{{ patient.smoking_status }}</td>
                        <td>
                            <span style="color: {{ 'red' if patient.stroke == 1 else 'green' }}; font-weight: bold;">
                                {{ 'Yes' if patient.stroke == 1 else 'No' }}
                            </span>
                        </td>
                        <td>
                            <a href="{{ url_for('patient_detail', patient_id=patient.id) }}" class="btn btn-primary btn-sm">View</a>
                            <a href="{{ url_for('edit_patient', patient_id=patient.id) }}" class="btn btn-secondary btn-sm">Edit</a>
                            <form method="POST" action="{{ url_for('delete_patient', patient_id=patient.id) }}" style="display: inline;">
                                <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure you want to delete this patient?')">Delete</button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                {% else %}
                    <tr>
                        <td colspan="12" style="text-align: center; padding: 30px; color: #666;">
                            No patients found. Load the dataset or add patients manually.
                        </td>
                    </tr>
                {% endif %}
            </tbody>
        </table>
    </div>
    
    <div class="pagination">
        {% if page > 1 %}
            <a href="{{ url_for('patients', page=page-1) }}">Previous</a>
        {% endif %}
        <span style="padding: 8px 15px;">Page {{ page }}</span>
        {% if patients and patients|length == 20 %}
            <a href="{{ url_for('patients', page=page+1) }}">Next</a>
        {% endif %}
    </div>
</div>
{% endblock %}
